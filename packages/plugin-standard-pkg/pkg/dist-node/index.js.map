{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import path from 'path';\nimport fs from 'fs';\nimport { MessageError } from '@pika/types';\nimport { Lint, Build } from 'standard-pkg';\nexport async function beforeJob({ cwd }) {\n    const srcDirectory = path.join(cwd, 'src/');\n    if (!fs.existsSync(srcDirectory)) {\n        throw new MessageError('@pika/pack expects a standard package format, where package source must live in \"src/\".');\n    }\n    if (!fs.existsSync(path.join(cwd, 'src/index.js')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.ts')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.jsx')) &&\n        !fs.existsSync(path.join(cwd, 'src/index.tsx'))) {\n        throw new MessageError('@pika/pack expects a standard package format, where the package entrypoint must live at \"src/index\".');\n    }\n}\nexport async function afterJob({ out, reporter }) {\n    reporter.info('Linting with standard-pkg...');\n    const linter = new Lint(path.join(out, 'dist-src'));\n    await linter.init();\n    linter.summary();\n}\nexport function manifest(newManifest) {\n    newManifest.esnext = newManifest.esnext || 'dist-src/index.js';\n    return newManifest;\n}\nexport async function build({ cwd, out, options, reporter }) {\n    const builder = new Build(path.join(cwd, 'src'), options);\n    await builder.init();\n    await builder.write(path.join(out, '/dist-src/'));\n    reporter.created(path.join(out, 'dist-src', 'index.js'), 'esnext');\n}\n"],"names":["beforeJob","cwd","srcDirectory","path","join","fs","existsSync","MessageError","afterJob","out","reporter","info","linter","Lint","init","summary","manifest","newManifest","esnext","build","options","builder","Build","write","created"],"mappings":";;;;;;;;;;;AAIO,eAAeA,SAAf,CAAyB;AAAEC,EAAAA;AAAF,CAAzB,EAAkC;AACrC,QAAMC,YAAY,GAAGC,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,MAAf,CAArB;;AACA,MAAI,CAACI,EAAE,CAACC,UAAH,CAAcJ,YAAd,CAAL,EAAkC;AAC9B,UAAM,IAAIK,kBAAJ,CAAiB,yFAAjB,CAAN;AACH;;AACD,MAAI,CAACF,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,cAAf,CAAd,CAAD,IACA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,cAAf,CAAd,CADD,IAEA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,eAAf,CAAd,CAFD,IAGA,CAACI,EAAE,CAACC,UAAH,CAAcH,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,eAAf,CAAd,CAHL,EAGqD;AACjD,UAAM,IAAIM,kBAAJ,CAAiB,sGAAjB,CAAN;AACH;AACJ;AACM,eAAeC,QAAf,CAAwB;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAxB,EAA2C;AAC9CA,EAAAA,QAAQ,CAACC,IAAT,CAAc,8BAAd;AACA,QAAMC,MAAM,GAAG,IAAIC,gBAAJ,CAASV,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,UAAf,CAAT,CAAf;AACA,QAAMG,MAAM,CAACE,IAAP,EAAN;AACAF,EAAAA,MAAM,CAACG,OAAP;AACH;AACM,SAASC,QAAT,CAAkBC,WAAlB,EAA+B;AAClCA,EAAAA,WAAW,CAACC,MAAZ,GAAqBD,WAAW,CAACC,MAAZ,IAAsB,mBAA3C;AACA,SAAOD,WAAP;AACH;AACM,eAAeE,KAAf,CAAqB;AAAElB,EAAAA,GAAF;AAAOQ,EAAAA,GAAP;AAAYW,EAAAA,OAAZ;AAAqBV,EAAAA;AAArB,CAArB,EAAsD;AACzD,QAAMW,OAAO,GAAG,IAAIC,iBAAJ,CAAUnB,IAAI,CAACC,IAAL,CAAUH,GAAV,EAAe,KAAf,CAAV,EAAiCmB,OAAjC,CAAhB;AACA,QAAMC,OAAO,CAACP,IAAR,EAAN;AACA,QAAMO,OAAO,CAACE,KAAR,CAAcpB,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,YAAf,CAAd,CAAN;AACAC,EAAAA,QAAQ,CAACc,OAAT,CAAiBrB,IAAI,CAACC,IAAL,CAAUK,GAAV,EAAe,UAAf,EAA2B,UAA3B,CAAjB,EAAyD,QAAzD;AACH;;;;;;;"}